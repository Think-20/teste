<mat-accordion>
  <mat-expansion-panel *ngFor="let task of sortedTasks; let i = index" [expanded]="i == expandedIndex">
    <mat-expansion-panel-header>
      <mat-panel-title>
        <p class="lead">
          <span>{{ taskService.jobDisplay(task.task) }} {{ description(task) }}</span>
          <br>
          <span *ngIf="task?.specification_files?.length > 0" class="lead subtitle">{{ task?.specification_files[task.specification_files.length - 1]?.responsible?.name + ' | ' + (task.specification_files[task.specification_files.length - 1].updated_at | date: 'dd/MM/yyyy HH:mm') }}</span>
        </p>
      </mat-panel-title>
    </mat-expansion-panel-header>
    <cb-file-upload [properties]="{ task : task }" [files]="task.specification_files" [fileServiceInterface]="specificationFileService" [typeForm]="typeForm"></cb-file-upload>
    <div *ngIf="task?.specification_files?.length > 0" class="row">
      <div class="col-md-12 text-right">
        <button mat-button class="cb-button button-navigate"
          type="button" (click)="navigateToBudget(task)">
          IR PARA AGENDA DO ORÃ‡AMENTO
        </button>
      </div>
    </div>
    <cb-budget-form class="inside-mat-card" *ngIf="task?.specification_files?.length > 0" [task]="task" [job]="job"></cb-budget-form>
  </mat-expansion-panel>
</mat-accordion>

